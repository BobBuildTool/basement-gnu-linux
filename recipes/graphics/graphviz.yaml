inherit: [cmake, python3]

metaEnvironment:
    PKG_VERSION: "13.1.2"

depends:
    - libs::cairo-dev
    - libs::pango-dev
    - libs::fontconfig-dev
    - libs::expat-dev

    - use: []
      depends:
          - libs::cairo-tgt
          - libs::pango-tgt
          - libs::fontconfig-tgt
          - libs::expat-tgt

checkoutSCM:
    scm: url
    url: https://gitlab.com/graphviz/graphviz/-/archive/${PKG_VERSION}/graphviz-${PKG_VERSION}.tar.bz2
    digestSHA256: c062e7ef870b2b2d0196076b601839316ede3a5a10efad2e9d9f2d3fbd9d57ca
    stripComponents: 1

buildTools: [bison, flex]
buildScript: |
    cmakeBuild $1 \
      -DWITH_GVEDIT=OFF \
      -DCMAKE_SKIP_INSTALL_RPATH=ON \
      -DCMAKE_BUILD_RPATH_USE_ORIGIN=ON \
      -Dwith_sfdp=OFF

packageScript: |
    cmakePackageTgt

provideDeps: ["*-tgt"]

provideTools:
    dot:
        path: "usr/bin"
        libs: ["usr/lib"]
